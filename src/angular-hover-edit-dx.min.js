!function(){"use strict";angular.module("hoverEdit",[]).directive("hoverEdit",["$animate","$compile",function(e,n){return{priority:100,restrict:"EA",require:["?hoverEditPermissions","?messageService"],scope:{saveFn:"=saveFn",addFn:"=addFn",cancelFn:"=cancelFn",unitToSave:"=unitToSave",editMode:"=editMode",formName:"@formName",readOnly:"=readOnly"},transclude:!0,templateUrl:"app/sharedServices/hover-edit/hover-edit-tpl.html",link:function(o,t,i,s){function a(n){if(!o.editMode.on){var i=t.children(".editContainer");null!==i&&(i=angular.element(i),n?(e.addClass(i,"edit-box"),e.removeClass(i,"box-border"),o.showIcon=!1):(e.addClass(i,"box-border"),e.removeClass(i,"edit-box"),o.showIcon=!0))}}function d(n){n&&_.isFunction(o.addFn())&&o.addFn();var i=t.children(".editContainer");o.editMode.on=!0,e.removeClass(t,"disabled"),e.addClass(i,"box-border"),e.removeClass(i,"edit-box")}function r(){var e=$("#"+o.formName);e&&e.hasClass("ng-invalid")||(_.isFunction(o.saveFn)?(o.showSpinner=!0,o.saveFn(o.unitToSave).then(function(){o.showSpinner=!1,o.editMode.on=!1,u(),s[1]&&s[1].showMessage.success("")("Save Successful")})["catch"](function(){o.showSpinner=!1})):(o.editMode.on=!1,u()))}function l(){o.editMode.on=!1,_.isFunction(o.cancelFn)&&o.cancelFn(),u()}function c(){o.addFn&&(m.after(v),n(v)(o)),s[0]&&!s[0].hasPermissions||(m.append(p),m.after(b),m.after(h)),m.addClass("edit-box"),t.addClass("disabled"),n(p)(o),n(b)(o),n(h)(o)}function u(){a(!0),t.addClass("disabled")}var p=angular.element('<span class="top-rt-corner-box"><i class="lds-icon lds-icon-pencil"></i></span>'),h=angular.element('<div class="save-exit-btns"><button class="btn btn-danger-hover" ng-disabled="showSpinner" ng-show="editMode.on" ng-click="functions.cancel()" tooltip-popup-delay="500" tooltip-append-to-body="true" tooltip="Cancel Changes" style="float: right">CANCEL</button><button class="btn btn-success-hover" ng-disabled="showSpinner" type="submit" form="{{formName}}" ng-show="editMode.on" ng-click="functions.save()" tooltip-popup-delay="500" tooltip-append-to-body="true" tooltip="Save Changes" style="float: right;margin-right: 2px">SAVE</button></div>'),v=angular.element('<button class="margin-bot-5 btn btn-default add-btn add-restriction" ng-show="editMode.on" ng-click="setEditMode(true)" tooltip-popup-delay="500" tooltip-append-to-body="true" tooltip="Add Restriction"><i class="lds-icon lds-icon-add"></i> </button>'),b=angular.element('<div class="hover-edit-spinner" ng-show="showSpinner"><util-spinner></util-spinner></div>'),m=t.children(".editContainer");o.$watch("readOnly",function(e,t){e!=t&&(e?(o.triggerhoverAnimation=null,o.setEditMode=null,p.remove()):s[0]&&!s[0].hasPermissions||(o.triggerhoverAnimation=a,o.setEditMode=d,m.append(p),n(p)(o)))}),(!o.readOnly&&!s[0]||s[0].hasPermissions)&&(o.triggerhoverAnimation=a,o.setEditMode=d),o.functions={save:r,cancel:l},c(),o.editMode={on:!1},o.showIcon=!1,o.showSpinner=!1}}}])}();