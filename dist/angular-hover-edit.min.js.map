{"version":3,"sources":["angular-hover-edit-dx.js"],"names":["angular","module","directive","$animate","$compile","priority","restrict","require","scope","saveFn","addFn","cancelFn","unitToSave","editMode","formName","readOnly","transclude","template","link","element","attrs","ctrls","showAddIcon","_","isFunction","on","triggerhoverAnimation","leaving","outerBox","children","addClass","removeClass","showIcon","setEditMode","addMode","save","form","document","getElementById","hasClass","showSpinner","then","hideEditElements","showMessage","success","cancel","setupElements","editBox","after","addIcon","hasPermissions","append","elemIcon","saveSpinner","saveExitIcons","cancelClick","event","$watch","nv","ov","remove","functions","className","onClick","bindToController","controllerAs","controller","$location","$rootScope","hoverEditLink","this","handleLinkAction","stopPropagation","path"],"mappings":"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","file":"angular-hover-edit.min.js","sourcesContent":["/**\n * Created by ericjohndixon on 7/29/15.\n */\n// Code goes here\n(function () {\n    'use strict';\n\n    angular.module('angularHoverEdit', [])\n        .directive('hoverEdit', ['$animate', '$compile', function ($animate, $compile) {\n            return {\n                priority: 100,\n                restrict: 'EA',\n                require: ['?hoverEditPermissions', '?messageService'],\n                scope: {\n                    saveFn: '=?saveFn',\n                    addFn: '=?addFn',\n                    cancelFn: '=?cancelFn',\n                    unitToSave: '=?unitToSave',\n                    editMode: '=?editMode', //external trigger\n                    formName: '@formName',\n                    readOnly: '=?readOnly'\n                },\n                transclude: true,\n                template: '<div class=\"animated-element edit-container\" ' +\n                'ng-mouseover=\"(!editMode.on) ? triggerhoverAnimation(false) : \\'\\'\" ' +\n                'ng-mouseleave=\"(!editMode.on) ? triggerhoverAnimation(true) : \\'\\'\" ' +\n                'ng-click=\"setEditMode()\"ng-transclude></div>',\n                link: function (scope, element, attrs, ctrls) {\n                    var elemIcon = angular.element('<span class=\"top-rt-corner-box\"><i class=\"lds-icon lds-icon-pencil\"></i></span>');\n                    var saveExitIcons = angular.element('<div class=\"save-exit-btns\">'+\n                        '<button class=\"btn btn-danger-hover\" ng-disabled=\"showSpinner\" type=\"button\" ng-show=\"editMode.on\" ng-click=\"functions.cancel()\" tooltip-popup-delay=\"500\" tooltip-append-to-body=\"true\" tooltip=\"Cancel Changes\" style=\"float: right\">CANCEL</button>' +\n                        '<button class=\"btn btn-success-hover\" ng-disabled=\"showSpinner\" type=\"submit\" form=\"{{formName}}\" ng-show=\"editMode.on\" ng-click=\"functions.save()\" tooltip-popup-delay=\"500\" tooltip-append-to-body=\"true\" tooltip=\"Save Changes\" style=\"float: right;margin-right: 2px\">SAVE</button>' +\n\n                        '</div>');\n                    var addIcon = angular.element('<button class=\"margin-bot-5 btn btn-default add-btn add-restriction\" type=\"button\" ng-show=\"showAddIcon()\" ng-click=\"setEditMode(true)\" tooltip-popup-delay=\"500\" tooltip-append-to-body=\"true\" tooltip=\"Add Restriction\"><i class=\"lds-icon lds-icon-add\"></i> </button>');\n                    var saveSpinner = angular.element('<div class=\"hover-edit-spinner\" ng-show=\"showSpinner\"><util-spinner></util-spinner></div>');\n\n\n                    var editBox = element.children('.editContainer');\n                    scope.cancelClick = function cancelClick(event) {\n                        event;\n                    };\n\n                    scope.$watch('readOnly', function(nv, ov) {\n                        if (nv != ov) {\n                            if (nv) {\n                                scope.triggerhoverAnimation = null;\n                                scope.setEditMode = null;\n                                elemIcon.remove();\n                            } else {\n                                if(!ctrls[0] || ctrls[0].hasPermissions) {\n                                    scope.triggerhoverAnimation = triggerhoverAnimation;\n                                    scope.setEditMode = setEditMode;\n                                    editBox.append(elemIcon);\n                                    $compile(elemIcon)(scope);\n                                }\n                            }\n                        }\n                    });\n\n                    if(!scope.readOnly && (!ctrls[0] || ctrls[0].hasPermissions)) {\n                        scope.triggerhoverAnimation = triggerhoverAnimation;\n                        scope.setEditMode = setEditMode;\n                    }\n\n                    scope.functions = {\n                        save: save,\n                        cancel: cancel\n                    };\n                    //scope.cancel = cancel;\n\n                    setupElements();\n                    scope.editMode = { on : false};\n                    scope.showIcon = false;\n                    scope.showSpinner = false;\n                    scope.showAddIcon = showAddIcon;\n\n                    function showAddIcon() {\n                        return _.isFunction(scope.addFn) && scope.editMode.on;\n                    }\n\n                    //trigger hover animation for mouseover(leaving = false) or mouseleaving (leaving = true)\n                    function triggerhoverAnimation(leaving) {\n                        if (!scope.editMode.on) {\n                            //var outerBox = document.querySelector(\"#editContainer\");\n                            var outerBox = element.children('.editContainer')[0];\n\n                            if (outerBox !== null)\n                            {\n                                outerBox = angular.element(outerBox);\n\n                                if (leaving) {\n                                    $animate.addClass(outerBox, 'edit-box');\n                                    $animate.removeClass(outerBox, 'box-border');\n                                    scope.showIcon = false;\n\n                                }\n                                else {\n                                    $animate.addClass(outerBox, 'box-border');\n                                    $animate.removeClass(outerBox, 'edit-box');\n                                    scope.showIcon = true;\n                                }\n                            }\n                        }\n                    }\n\n\n                    // clicking box for editing\n                    function setEditMode (addMode) {\n                        if(addMode && _.isFunction(scope.addFn)) {\n                            scope.addFn();\n                        }\n                        var outerBox = element.children('.editContainer');\n                        scope.editMode.on = true;\n                        $animate.removeClass(element, 'disabled');\n                        $animate.addClass(outerBox, 'box-border');\n                        $animate.removeClass(outerBox, 'edit-box');\n                    }\n\n                    //Save Icon Click\n                    function save() {\n                        //if there is a form associated with the element\n                        var form = angular.element(document.getElementById(scope.formName));\n\n                        //Only able to save if form is valid\n                        if (!form || !form.hasClass('ng-invalid')) {\n                            if (_.isFunction(scope.saveFn)) {\n                                scope.showSpinner = true;\n                                scope.saveFn(scope.unitToSave).then(function () {\n                                    scope.showSpinner = false;\n                                    //$compile(saveExitIcons)(scope);\n                                    scope.editMode.on = false;\n                                    hideEditElements();\n\n                                    if(ctrls[1]) {\n                                        ctrls[1].showMessage.success('')('Save Successful');\n                                    }\n                                }).catch(function() {\n                                    scope.showSpinner = false;\n                                });\n                            } else {\n                                scope.editMode.on = false;\n                                hideEditElements();\n                            }\n                        }\n\n                    }\n\n                    //Cancel Icon Click\n                    function cancel() {\n                        scope.editMode.on = false;\n                        if(_.isFunction(scope.cancelFn)) {\n                            scope.cancelFn();\n                        }\n                        hideEditElements();\n                    }\n\n                    // initial creation of elements\n                    function setupElements() {\n                        editBox.after(addIcon);\n                        $compile(addIcon)(scope);\n                        if (!scope.readOnly && (!ctrls[0] || ctrls[0].hasPermissions)) {\n                            editBox.append(elemIcon);\n                            $compile(elemIcon)(scope);\n                        }\n                        if(!ctrls[0] || ctrls[0].hasPermissions) {\n                            editBox.after(saveSpinner);\n                            editBox.after(saveExitIcons);\n                            $compile(saveSpinner)(scope);\n                            $compile(saveExitIcons)(scope);\n                        }\n\n                        editBox.addClass('edit-box');\n                        element.addClass('disabled');\n                    }\n\n                    function hideEditElements() {\n                        triggerhoverAnimation(true);\n                        element.addClass('disabled');\n                    }\n                }\n            };\n        }])\n        .directive('utilSpinner', [function () {\n            return {\n                restrict: 'E',\n                template: '<span us-spinner=\"{radius:4, width:2, length: 2, lines: 9, scale: 1.5, corners: 1.0, speed: 2.0, hwaccel: true, trail: 100, className: className}\"></span>',\n                scope: {\n                    className: '@className'\n                }\n            };\n\n        }])\n        .directive('hoverEditLink', [function(){\n            return {\n                restrict: 'EA',\n                template: '<span class=\"hover-edit-link\" ng-click=\"hoverEditLink.handleLinkAction($event)\" ng-transclude></span>',\n                transclude: true,\n                scope: {\n                    link: '@?link',\n                    onClick: '&?onClick'\n                },\n                bindToController: true,\n                controllerAs: 'hoverEditLink',\n                controller: ['$location', '$rootScope', function($location, $rootScope){\n                    var hoverEditLink = this;\n                    hoverEditLink.handleLinkAction = function(event) {\n                        //disallow edit mode if link is clicked\n                        event.stopPropagation();\n                        if (hoverEditLink.onClick) {\n                            hoverEditLink.onClick();\n                        } else {\n                            // will add '/' if missing\n                            $location.path(hoverEditLink.link);\n                        }\n                    }\n                }]\n            }\n        }]);\n\n})();\n"],"sourceRoot":"/source/"}